<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RME Reviewer - Quiz</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0f1724;
      color: #fff;
      margin: 0;
      padding: 20px;
      text-align: center;
      transition: background 0.3s, color 0.3s;
    }
    .card {
      background: #0b1220;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.6);
      max-width: 600px;
      margin: auto;
      transition: background 0.3s;
    }
    h1 {
      color: #06b6d4;
    }
    select {
      margin-top: 15px;
      padding: 6px;
      border-radius: 6px;
      border: none;
      font-size: 14px;
    }
    .question {
      font-size: 18px;
      margin: 40px 0 20px 0;
    }
    .options button {
      display: block;
      width: 100%;
      margin: 8px 0;
      padding: 12px;
      background: #1e293b;
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
    }
    .options button:hover {
      background: #06b6d4;
    }
    .correct {
      background: #10b981 !important;
    }
    .wrong {
      background: #ef4444 !important;
    }
    #nextBtn {
      margin-top: 20px;
      padding: 12px 20px;
      background: #06b6d4;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      display: none;
    }
    #score {
      margin-top: 15px;
      font-size: 18px;
      color: #94a3b8;
    }
    #status {
      margin: 15px 0;
      font-size: 16px;
      font-weight: bold;
      color: #ef4444;
    }

    /* Small buttons */
    .small-btns {
      margin-top: 15px;
      display: flex;
      justify-content: center;
      gap: 10px;
    }
    .small-btns button {
      padding: 8px 14px;
      font-size: 14px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      background: #1e293b;
      color: #fff;
      transition: 0.3s;
    }
    .small-btns button:hover {
      background: #06b6d4;
    }

    .ad-space {
      margin: 10px 0;
      background: #1e293b;
      padding: 10px;
      border-radius: 8px;
      color: #94a3b8;
      font-size: 14px;
    }

    /* Light mode */
    body.light {
      background: #f9f9f9;
      color: #000;
    }
    body.light .card {
      background: #fff;
      color: #000;
    }
    body.light h1 {
      color: #0f1724;
    }
    body.light .options button {
      background: #e2e8f0;
      color: #000;
    }
    body.light .options button:hover {
      background: #06b6d4;
      color: #fff;
    }
    body.light #score {
      color: #333;
    }
    body.light #status {
      color: #b91c1c;
    }
    body.light .small-btns button {
      background: #e2e8f0;
      color: #000;
    }
    body.light .ad-space {
      background: #e2e8f0;
      color: #475569;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>RME Reviewer</h1>

    <!-- Ad space 1 -->
    <div class="ad-space">Ad Space 1</div>

    <!-- Mode Dropdown -->
    <label for="modeSelect">Mode:</label>
    <select id="modeSelect" disabled>
      <option value="all">All Questions</option>
      <option value="wrong">Only Didn't Know</option>
    </select>

    <div id="status"></div>

    <div id="quiz" style="display:none;">
      <div class="question" id="question">Loading...</div>
      <div class="options" id="options"></div>
      <button id="nextBtn">Next</button>
      <div id="score"></div>

      <!-- Reset, Shuffle & Back Buttons Centered -->
      <div class="small-btns">
        <button id="resetBtn">Reset</button>
        <button id="shuffleBtn">Shuffle</button>
        <button id="backBtn">Back</button>
      </div>
    </div>
  </div>

  <!-- Ad space 2 (bottom, outside card) -->
  <div class="ad-space">Ad Space 2</div>

  <script>
    let allQuestions = [
      {
        question: "What is the standard frequency of electricity in the Philippines?",
        options: ["50 Hz", "60 Hz", "120 Hz", "100 Hz"],
        answer: 1
      },
      {
        question: "In Ohm’s Law, what does V = IR stand for?",
        options: [
          "Voltage = Current × Resistance",
          "Voltage = Current ÷ Resistance",
          "Voltage = Power ÷ Current",
          "Voltage = Energy × Time"
        ],
        answer: 0
      },
      {
        question: "What color is used for grounding conductors?",
        options: ["Red", "Yellow", "Green", "Blue"],
        answer: 2
      },
      {
        question:"Bends in type SNM cable (Shielded Non-metallic sheathed cable) must be such that the inner radius shall not be less than _____ times the cable diameter.",
        options:["4","5","6","7"],
        answer:1
      }
    ];

    let currentQuestion = 0;
    let score = 0;
    let wrongQuestions = [];
    let mode = "all";

    const questionEl = document.getElementById("question");
    const optionsEl = document.getElementById("options");
    const nextBtn = document.getElementById("nextBtn");
    const scoreEl = document.getElementById("score");
    const modeSelect = document.getElementById("modeSelect");
    const quizEl = document.getElementById("quiz");
    const statusEl = document.getElementById("status");
    const resetBtn = document.getElementById("resetBtn");
    const shuffleBtn = document.getElementById("shuffleBtn");
    const backBtn = document.getElementById("backBtn");

    function getActiveQuestions() {
      return mode === "all" ? allQuestions : wrongQuestions;
    }

    function loadQuestion() {
      const active = getActiveQuestions();
      if (active.length === 0) {
        questionEl.textContent = "No questions to show in this mode.";
        optionsEl.innerHTML = "";
        nextBtn.style.display = "none";
        return;
      }
      const q = active[currentQuestion];
      questionEl.textContent = q.question;
      optionsEl.innerHTML = "";
      q.options.forEach((opt, i) => {
        const btn = document.createElement("button");
        btn.textContent = opt;
        btn.onclick = () => checkAnswer(i, btn);
        optionsEl.appendChild(btn);
      });
    }

    function checkAnswer(selected) {
      const active = getActiveQuestions();
      const correct = active[currentQuestion].answer;
      const buttons = optionsEl.querySelectorAll("button");
      buttons.forEach((b, i) => {
        if (i === correct) b.classList.add("correct");
        if (i === selected && i !== correct) b.classList.add("wrong");
        b.disabled = true;
      });
      if (selected === correct) {
        score++;
      } else {
        if (!wrongQuestions.includes(active[currentQuestion])) {
          wrongQuestions.push(active[currentQuestion]);
        }
      }
      scoreEl.textContent = `Score: ${score} / ${allQuestions.length}`;
      nextBtn.style.display = "block";
    }

    nextBtn.onclick = () => {
      const active = getActiveQuestions();
      currentQuestion++;
      if (currentQuestion < active.length) {
        loadQuestion();
        nextBtn.style.display = "none";
      } else {
        questionEl.textContent = "Review Finished!";
        optionsEl.innerHTML = "";
        nextBtn.style.display = "none";
      }
    };

    modeSelect.addEventListener("change", () => {
      mode = modeSelect.value;
      currentQuestion = 0;
      loadQuestion();
      nextBtn.style.display = "none";
    });

    // Reset quiz
    resetBtn.onclick = () => {
      currentQuestion = 0;
      score = 0;
      wrongQuestions = [];
      scoreEl.textContent = "";
      loadQuestion();
      nextBtn.style.display = "none";
    };

    // Shuffle questions
    shuffleBtn.onclick = () => {
      allQuestions = allQuestions.sort(() => Math.random() - 0.5);
      resetBtn.click();
    };

    // Back button
    backBtn.onclick = () => {
      window.location.href = "second.html";
    };

    function updateOnlineStatus() {
      if (navigator.onLine) {
        statusEl.textContent = "";
        quizEl.style.display = "block";
        modeSelect.disabled = false;
        loadQuestion();
      } else {
        statusEl.textContent = "⚠️ You are offline. Please connect to the internet to start the quiz.";
        quizEl.style.display = "none";
        modeSelect.disabled = true;
      }
    }

    window.addEventListener("online", updateOnlineStatus);
    window.addEventListener("offline", updateOnlineStatus);

    if (localStorage.getItem('theme') === 'light') {
      document.body.classList.add('light');
    }

    updateOnlineStatus();
  </script>
</body>
</html>
